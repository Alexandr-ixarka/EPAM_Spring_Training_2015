using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace BL
{
    public class DataCollector
    {
        private string[] userNames = new string[]
        {
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Вася",
            "Петя",
            "Оля",
            "Саша",
            "Гриша"
        };

        private DAL.IModelRepository<DAL.Models.User> userRepository = new DAL.UserRepository();

        #region
        private object userOpSync = new object();

        public void AddUser(DAL.Models.User user)
        {
            userRepository.Add(user);
            userRepository.SaveChanges();
        }

        public Task ProcessFile()
        {
            var task = new Task(t1);
            task.Start();
            //t1();
            return task;
        }

        private void t1()
        {
            foreach (var c in userNames)
            {
                lock (userOpSync)
                {
                    var u = userRepository.Items.FirstOrDefault(x => x.UserName == c);
                    if (u == null)
                    {
                        userRepository.Add(new DAL.Models.User() { UserName = c });
                    }
                    userRepository.SaveChanges();
                }
            }
        }



        #endregion
    }
}
